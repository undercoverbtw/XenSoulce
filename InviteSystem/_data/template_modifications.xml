<?xml version="1.0" encoding="utf-8"?>
<template_modifications>
  <modification type="public" template="account_visitor_menu" modification_key="xs_is_add_link_account_visitor_menu" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<!--\[XF:account_links:bottom\]-->\s*<\/ul>/s]]></find>
    <replace><![CDATA[<xf:if is="$xf.visitor.canInvite()">
	<li><a href="{{ link('account/invitation') }}" class="menu-linkRow">{{ phrase('xs_is_invitation_code') }}</a></li>
</xf:if>
$0]]></replace>
  </modification>
  <modification type="public" template="account_wrapper" modification_key="xs_is_add_link_account_wrapper" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<!--\[XF:settings_links:bottom\]-->\s*<\/div>/s]]></find>
    <replace><![CDATA[<xf:if is="$xf.visitor.canInvite()">
	<a class="blockLink {{ $pageSelected == 'xs_Invitation' ? 'is-selected' : '' }}" href="{{ link('account/invitation') }}">
		{{ phrase('xs_is_invitation_code') }}
	</a>
</xf:if>
$0]]></replace>
  </modification>
  <modification type="email" template="af_paidregistrations_receipt" modification_key="xs_is_invitation_email_addonflare" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/(<p>(.*?)<\/p>)/]]></find>
    <replace><![CDATA[$0
<p><b>{{ phrase('xs_is_invitation_code:') }}</b> {$purchaseRequest.extra_data.invitation_code}</p>]]></replace>
  </modification>
  <modification type="admin" template="helper_criteria" modification_key="xs_is_add_criteria" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<!--\[XF:user:after_groups\]-->/s]]></find>
    <replace><![CDATA[<xf:macro template="xs_is_criteria_macro" name="criteria"
		  arg-criteria="{$criteria}" />
$0]]></replace>
  </modification>
  <modification type="public" template="member_tooltip" modification_key="xs_is_ad_invite_by_in_member_tooltip" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/(<dl class="pairs pairs--inline.*<xf:date time=")(.*<\/dl>)/Us]]></find>
    <replace><![CDATA[$0
<xf:if is="$user.InviteUser.User">
	<dl class="pairs pairs--inline">
		<dt>{{ phrase('xs_is_invited_by') }}</dt>
		<dd><xf:username user="$user.InviteUser.User" rich="true" /></dd>
	</dl>
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="member_view" modification_key="xs_is_ad_invite_by_in_member_view" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/(<dl class="pairs pairs--inline.*<xf:date time=")(.*<\/dl>)/Us]]></find>
    <replace><![CDATA[$0
<xf:if is="$user.InviteUser.User">
	<dl class="pairs pairs--inline">
		<dt>{{ phrase('xs_is_invited_by') }}</dt>
		<dd><xf:username user="$user.InviteUser.User" rich="true" /></dd>
	</dl>
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="member_view" modification_key="xs_is_add_invitation_tab_in_member_view" description="tab" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<!--\[XF:tabs:after_recent_content\]-->/s]]></find>
    <replace><![CDATA[$0
<a href="{{ link('members/invitations', $user) }}"
   class="tabs-tab"
   id="xsInvitations"
   role="tab">{{ phrase('xs_is_invitations') }}</a>
]]></replace>
  </modification>
  <modification type="public" template="member_view" modification_key="xs_is_add_invitation_tab_in_member_view_panel" description="tab panel" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<!--\[XF:tab_panes:after_recent_content\]-->/s]]></find>
    <replace><![CDATA[$0

	<li data-href="{{ link('members/invitations', $user) }}" role="tabpanel" aria-labelledby="srcReferrals">
		<div class="blockMessage">{{ phrase('loading...') }}</div>
	</li>]]></replace>
  </modification>
  <modification type="public" template="register_connected_account" modification_key="xs_is_add_register_connected_account" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/(<xf:macro template="register_macros" name="location_row")(.*?)(<\/xf:if>)/s]]></find>
    <replace><![CDATA[$0
<xf:if is="$xf.options.xs_is_code_required.mandatory == 'yes'">
	<xf:textboxrow name="code" label="{{ phrase('xs_is_code') }}"
			   hint="{{ phrase('required') }}"
			   explain="{{ phrase('xs_is_code_explain') }}" 
			   required="required"/>
	<xf:else/>
	<xf:textboxrow name="code" label="{{ phrase('xs_is_code') }}"
			   explain="{{ phrase('xs_is_code_explain') }}" />
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="register_form" modification_key="xs_is_add_register_form" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/(<xf:passwordboxrow name=".*required="required")(.*\/>)/Us]]></find>
    <replace><![CDATA[$0
<xf:if is="$xf.options.xs_is_code_required.mandatory == 'yes'">
	<xf:textboxrow name="code" label="{{ phrase('xs_is_code') }}"
			   hint="{{ phrase('required') }}"
			   explain="{{ phrase('xs_is_code_explain') }}" 
			   required="required"/>
	<xf:else/>
	<xf:textboxrow name="code" label="{{ phrase('xs_is_code') }}"
			   explain="{{ phrase('xs_is_code_explain') }}" />
</xf:if>]]></replace>
  </modification>
</template_modifications>
